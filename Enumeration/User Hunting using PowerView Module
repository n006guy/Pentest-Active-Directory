Below are commands that used for High Privilege User hunting using PowerView. 

  • Find-LocalAdminAccess --> Use this command to find all machines on the current domain where the current user has local admin access.
  • Find-WMILocalAdminAccess.ps1 --> find all machines on the current domain where the current user has local admin access using remote admin tools like WMI and Powershell remoting. (List of computers needs to be provided and script will work if the user running has local admin rights)
  • Invoke-CheckLocalAdminAccess --> Checks whether our user has local admin access on given computer. 
      • This raises 4624 (logon) and 4634 (logoff) events on the windows.
  • Invoke-EnumerateLocalAdmin --> Use this command to find local admins on all machines of the domain (Needs administrator privs on non-dc machines)
  • Get-NetLocalGroup --> Provides information of about the local group on a particular machine.
  • Invoke-UserHunter -->  Find computers where a domain admin has sesssions and also checks whether our user (the user used for running the PowerShell Session) has local admin access on the same machine.
      • Gets list of computers and Domain Admin group (by default) from the DC and then checks with all the machines in the domain for domain admin session and also whether the currenr user running the command has local admin access to the machine where domain admin session is currently logged on. 
  • Invoke-userHunter -Stealth --> Works similar to the Invoke-UserHunter but will only go to high traffic servers like DC, SQL, File etc. May procide less results.
  • Invoke-UserHunter -GroupName group_name-->  Find computers where a specified user groups has sesssions and also checks whether a user running it has local admin access on the same machine.
  • Invoke-UserHunter -UserName username  --> Use this command to find computers where a specific user has local admin session on a computer where domain admin has session logged in.
  • Invoke-UserHunter -CheckAccess --> This is confirm the Invoke-UserHunter output.
  
  The above commands are very noisy in logs.
