Spots to look after for Local Privilege escalation
  • Missing Patches
  • Automated deployment and AutoLotgon passwords in clear text
  • AlwaysInstallElevated (Any user cam run MSI as system)
  • Misconfigured services
  • DLL Hijacking
  • Token impersonation
  • Manually checking files with credentials.
  • Serviceunquoted services :- Service path or executable a unquoted paths.
  • check with followinng command to get list of all service binary
  • Get-WMIObject -Class win32_service | select pathname
  • Modifiable files and service.:- Modify binary path pr change agruments to the binary.

PowerUp from PowerSploit (PoowerUp.ps1)
  • Get-Serviceunquoted -Verbose  --> Get services with unquoted paths and a space in their executable path
    • Always check whether the unquoted service is run by a privi user.
    • Always check whether the unquoted service can be restarted by us.
  • Get-ModifiabbleServiceFile -Verbose --> Get services where the current user can write to its binary path
  • Get-ModifiableService -Verbose --> Get the services which current user can modify
  • Invoke-AllChecks

Common Tools for Privilege Escalation
  • BeRoot tool
  • Privisec powershell script.
  • PowerUp.ps1

To disbale Real time monitoring of Windows Defender
•  Set-MpPreference -DisableRealtimeMonitoring $true
